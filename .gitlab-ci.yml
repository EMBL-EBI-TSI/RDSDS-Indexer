stages:
  - extract
  - report

extract-metabolights:
  image: "python:3.5"
  stage: extract
  before_script:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  script:
    - python scripts/extract-omicsdi-datasets.py metabolights
  artifacts:
    paths:
    - data/metabolights.csv
    expire_in: 1 week

extract-pride:
  image: "python:3.5"
  stage: extract
  before_script:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  script:
    - python scripts/extract-omicsdi-datasets.py pride
  artifacts:
    paths:
    - data/pride.csv
    expire_in: 1 week

.extract-arrayexpress:
  image: "python:3.5"
  stage: extract
  before_script:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  script:
    - python scripts/extract-omicsdi-datasets.py arrayexpress
  artifacts:
    paths:
    - data/arrayexpress.csv
    expire_in: 1 week

extract-eva:
  image: "python:3.5"
  stage: extract
  before_script:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  script:
    - python scripts/extract-omicsdi-datasets.py eva
  artifacts:
    paths:
    - data/eva.csv
    expire_in: 1 week

extract-expression-atlas:
  image: "python:3.5"
  stage: extract
  before_script:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  script:
    - python scripts/extract-omicsdi-datasets.py expression-atlas
  artifacts:
    paths:
    - data/expression-atlas.csv
    expire_in: 1 week

report:
  image: "alpine"
  stage: report
  script:
    - wc -l data/*.csv | tee data/report.txt
  artifacts:
    paths:
    - data/